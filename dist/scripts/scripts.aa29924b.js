"use strict";function changup(){return"bloop"}function starter(){var a=d3.selectAll("h4.bigtitle").html('Total number of Democrats: <span class="numDems">52</span> </br> Total number of Republicans: <span class="numRepu">28</span>'),a=d3.select(".maphold").style("width",width+"px").style("height",height+"px");a.append("div").attr("class","distinfo").style("background-color","white").style("width","200px").html("Click on a district to see details");var b=a.append("svg").attr("width",width).attr("height",height).style("background","black").style("border","2px solid grey");b.append("rect").attr("class","overlay").attr("width",width).attr("height",height).call(zoom),features=b.append("g"),b.call(zoom)}function makeho(a,b){d3.selectAll("path").remove(),d3.select(".chatit").text(function(){return"lower"==a?"Assembly":"Senate"}),d3.json("/ca"+a+".json",function(c){function d(){d3.select(".numDems").text(i),d3.select(".numRepu").text(h)}if(console.log(c.objects),"upper"===a)var e=topojson.neighbors(c.objects.caSenDist.geometries),f=topojson.feature(c,c.objects.caSenDist).features;else var e=topojson.neighbors(c.objects.assemD2011.geometries),f=topojson.feature(c,c.objects.assemD2011).features;console.log(e),features.selectAll(".casubun").data(f).enter().append("path").attr("class",function(){return"casubun"}).attr("d",path).style("fill",function(){return"green"}),"upper"===a?features.append("path").datum(topojson.mesh(c,c.objects.caSenDist,function(a){return a})).attr("d",path).attr("class","bords"):features.append("path").datum(topojson.mesh(c,c.objects.assemD2011,function(a){return a})).attr("d",path).attr("class","bords"),console.log("trying to do magic"),console.log(b);var g=b,h=0,i=0,j=d3.selectAll(".casubun").style("fill",function(a){var b="yellow",c=+a.properties.DISTRICT;return g.forEach(function(d){if(d.district==c){if(console.log("a match!"),"Republican"===d.party)return a.properties.party="Republican",a.properties.name=d.full_name,h++,b="red";a.properties.party="Democrat",a.properties.name=d.full_name,i++,b="blue"}}),d(),b});navigator.geolocation.getCurrentPosition(function(a){console.log("geoloc",a),lat=a.coords.latitude,lon=a.coords.longitude;var b=projection([lon,lat]);features.append("circle").attr("cx",function(){return console.log(projection([lon,lat])),b[0]}).attr("cy",function(){return b[1]}).attr("r","10").attr("fill","green").attr("class","myloc")}),console.log(j[0]),d3.selectAll(".casubun").on("click",function(a){console.log(this),d3.selectAll(".casubun").style("fill",makePcol).attr("class","casubun").attr("stroke","null");var b=d3.select(this);b.style("fill","fuchsia").attr("stroke","orange").attr("class","casubun hoved"),console.log(a),d3.select(".distinfo").html(function(){return console.log(a.properties.name),void 0!=a.properties.name?"District "+a.properties.DISTRICT+" "+a.properties.name:"District "+a.properties.DISTRICT+" is vacant"})}).on("mouseout",function(){console.log("outter there")})})}function mapit(){}function zoomed(){features.attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")"),features.selectAll(".bords").style("stroke-width",1.5/d3.event.scale+"px"),features.selectAll(".myloc").attr("r",8/d3.event.scale+"px")}function makePcol(a){return"Democrat"==a.properties.party?"blue":"Republican"==a.properties.party?"red":"yellow"}angular.module("poliprojApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/map",{templateUrl:"views/map.html",controller:"MapCtrl"}).otherwise({redirectTo:"/"})}]).service("Stater",["$q","$http",function(a,b){return{getData:function(){var c=a.defer();return b.get("/states.json",{cache:"true"}).success(function(a){c.resolve(a)}),c.promise}}}]).service("Peeps",["$q","$http","$rootScope",function(a,b,c){return{getData:function(d){var e=a.defer();return b.get("/db",{params:{state:"ca",house:d},cache:"true"}).success(function(a){console.log("peep success"),c.polies=a,e.resolve(a)}),e.promise}}}]);var url="/db",scope;angular.module("poliprojApp").controller("MainCtrl",["$scope","$http","Stater","$rootScope",function(a,b,c,d){function e(c){c=c,console.log(a.onState);var e={params:{state:a.onState.abbreviation,house:f}};b.get(c,e).success(function(b){console.log(b);var c=b;console.log(c),d.polies=c,a.beep=c.filter(function(a){return"Democratic"===a.party||"Democratic-Farmer-Labor"===a.party||"Democrat"===a.party}),console.log("leng of dems",a.beep.length),a.totdems=a.beep.length,a.reep=c.filter(function(a){return"Republican"===a.party}),a.totreps=a.reep.length}).error(function(a){console.log(a),console.log("error in the http req")})}a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.beep=[{district:"blah",full_name:""}],a.reep=[{district:"boon",full_name:""}],a.totdems=0,a.url=url,a.states=[{name:"California",abbreviation:"ca"},{name:"Nevada",abbreviation:"nv"}],a.onState=a.states[0],c.length>0&&(a.states=c,a.onState=a.states[4]),b.get("/states.json").success(function(b){c=b,a.states=b,a.onState=a.states[4],console.log(a.states)}).error(function(){console.log("didnt get the states")}),a.houses=["upper","lower"],d.onhouse=a.houses[1];var f=d.onhouse;console.log("onhose",d.onhouse),scope=a,a.$watch("onhouse",function(b){f=b,d.onhouse=b,a.states.length>5&&e(url)}),a.isnotCA=!1,a.$watch("onState",function(){a.states.length>5&&(e(url),"ca"===a.onState.abbreviation?(a.pict=!0,a.isnotCA=!1,a.ismap.link="#/map"):(a.pict=!1,a.isnotCA=!0,a.ismap.link="#/about"))}),a.ismap={content:"one day",show:!0,link:"#/map"};a.pict=!0,a.pict="ca"===a.onState.abbreviation?!0:!1}]),angular.module("poliprojApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["Sunlight foundation APIs","AngularJS","Karma"]}]);var pollly;angular.module("poliprojApp").controller("MapCtrl",["$scope","$rootScope","Stater","Peeps",function(a,b,c,d){starter(),e=b.polies,scope=a,console.log("making polies var"),console.log("gosh house var");var e=b.polies;if(void 0===e){console.log("aint no rootscope yet"),a.houses=["upper","lower"],void 0==b.onhouse&&(b.onhouse=a.houses[1]);var f=d.getData(b.onhouse).then(function(){e=b.polies,console.log(e),makeho(b.onhouse,e)});console.log(f),a.$watch("onhouse",function(c){a.houses=["upper","lower"],b.onhouse=c,d.getData(c).then(function(){e=b.polies,makeho(c,e)})})}else makeho(b.onhouse,e),a.$watch("onhouse",function(a){b.houses=["upper","lower"],b.onhouse=a,d.getData(a).then(function(){e=b.polies,makeho(a,e)})})}]);var features,width=960,height=600,lat,lon,projection=d3.geo.mercator().scale(2e3).translate([width/2,height/2]).center([-120,36]),path=d3.geo.path().projection(projection),zoom=d3.behavior.zoom().translate([0,0]).scale(1).scaleExtent([1,18]).on("zoom",zoomed),howie="upper";console.log("blah bloop");